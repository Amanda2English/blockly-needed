<!DOCTYPE html>
<html>
    <head>
        <script type="text/javascript" src="blockly_uncompressed.js"></script>
        <script type="text/javascript" src="blocks_compressed.js"></script>
        <script type="text/javascript" src="arduino_compressed.js"></script>
        <script type="text/javascript" src="javascript_compressed.js"></script>
        <script type="text/javascript" src="instructions_compressed.js"></script>
        <script type="text/javascript" src="msg/js/en.js"></script>

        <style>
            html, body, #blocklyDiv {
                margin: 0;
                padding: 0;
            }
        </style>
    </head>

    <body>
      <div id="blocklyDiv" style="height: 100vh; width: 100vw;">
        <xml id="toolbox" style="display: none;">
        <category name="Arduino">

            <block type="arduino_digital_write">
              <value name="pin">
                <block type="arduino_pin">
                  <field name="PIN">Output A</field>
                </block>
              </value>
              <value name="value">
                <block type="arduino_digital">
                  <field name="DIGITAL">HIGH</field>
                </block>
              </value>
            </block>

            <block type="arduino_digital_read">
              <value name="pin">
                <block type="arduino_pin">
                  <field name="PIN">Input 1</field>
                </block>
              </value>
            </block>

            <block type="arduino_analog_write">
              <value name="pin">
                <block type="arduino_pin">
                  <field name="PIN">Output A</field>
                </block>
              </value>
              <value name="value">
                <block type="math_number">
                  <field name="NUM">512</field>
                </block>
              </value>
            </block>

            <block type="arduino_analog_read">
              <value name="pin">
                <block type="arduino_pin">
                  <field name="PIN">Input 1</field>
                </block>
              </value>
            </block>

            <block type="arduino_tone">
              <value name="frequency">
                <block type="arduino_frequency">
                  <field name="NUM"></field>
                </block>
              </value>
              <value name="pin">
                <block type="arduino_pin">
                  <field name="PIN">Output A</field>
                </block>
              </value>
            </block>

            <block type="arduino_notone">
              <value name="pin">
                <block type="arduino_pin">
                  <field name="PIN">Output A</field>
                </block>
              </value>
            </block>

            <block type="arduino_delay">
              <value name="time">
                <block type="math_number">
                  <field name="NUM">1000</field>
                </block>
              </value>
            </block>

        </category>
        <category name="Flow">
            <block type="logic_compare"></block>
            <block type="controls_if"></block>
            <block type="controls_repeat_ext"></block>
            <block type="arduino_repeat_forever"></block>
        </category>
        <category name="Math">
            <block type="math_number"></block>
            <block type="math_arithmetic"></block>
        </category>
        <category name="Procedures" custom="PROCEDURE">
            <block type="procedures_defreturn"></block>
            <block type="procedures_defnoreturn"></block>
        </category>
        <category name="Variables" custom="VARIABLE">
            <block type="variables_get"></block>
            <block type="variables_set"></block>
        </category>
        </category>
        <category name="Values">
            <block type="arduino_pin"></block>
            <block type="arduino_tutorial_pin"></block>
            <block type="arduino_digital"></block>
            <block type="arduino_frequency"></block>
            <block type="arduino_switchstate"></block>
        </category>
        <category name="LightUp">
            <block type="arduino_disable_input_lights"></block>
        </category>
        </xml>
      </div>

      <a style="position: absolute; right: 10px; top: 10px;" href="#" onclick="console.log(Blockly.Arduino.workspaceToCode());">Generate Arduino</a>

    </body>
 
  <script type="text/javascript">

    Blockly.HSV_SATURATION = 0.60;
    Blockly.HSV_VALUE = 0.84;

    var ORANGE = '#FFCE5D';
    var PURPLE = '#A05EB5';
    var GREEN = '#8EDD65';
    var BLUE = '#55C7D6';
    var RED = '#E56A54';

    var fallbackMakeColour = Blockly.makeColour;
    Blockly.makeColour = function(saturation) {
        var map = {
            30: ORANGE,
            345: PURPLE,
            135: GREEN,
            210: BLUE,
            290: RED
        };

        if (map[saturation]) {
            return map[saturation];
        } else {
            return fallbackMakeColour(saturation);
        }
    };

    var colorForId = function(id) {
        var map = {
            1: ORANGE,
            2: PURPLE,
            3: GREEN,
            4: BLUE,
            5: RED,
            6: ORANGE,
            7: PURPLE
        };

        return map[id];
    }

    var setSelectedItem = Blockly.Toolbox.TreeControl.prototype.setSelectedItem;


    Blockly.Toolbox.TreeControl.prototype.setSelectedItem = function(node) {
      setSelectedItem.call(this, node);

      if (!node || !node.id_) {
        return;
      }
      this.toolbox_.flyout_.svgBackground_.style.stroke = colorForId(node.id_.substring(1));
    };

    Blockly.Css.CONTENT.splice(Blockly.Css.CONTENT.indexOf('.blocklySvg {') + 1, 1, 'background-color: #ddddff;');
    Blockly.Css.CONTENT.splice(Blockly.Css.CONTENT.indexOf('.blocklyTreeRow {') + 1, 4, 'border-radius: 10px; padding-top: 12px; padding-bottom: 12px; margin-left: 10px; margin-top: 10px; margin-right: 10px; margin-bottom: 10px; text-align: center; color: white;');

    Blockly.Css.CONTENT.splice(Blockly.Css.CONTENT.indexOf('.blocklyFlyoutBackground {') + 2, 1, 'fill: white; stroke-width: 3px;');
    Blockly.Css.CONTENT.splice(Blockly.Css.CONTENT.indexOf('.blocklyHighlightedConnectionPath {') + 2, 1, 'stroke: #E56A54;');
    Blockly.Css.CONTENT.splice(Blockly.Css.CONTENT.indexOf('.blocklyTreeSelected  {') + 1, 1, 'border-top-right-radius: 0; border-bottom-right-radius: 0; margin-right: 0;');
    Blockly.Css.CONTENT.splice(Blockly.Css.CONTENT.indexOf('.blocklyTreeLabel {') + 4, 1, 'font-size: 16px;');
    Blockly.Css.CONTENT.splice(Blockly.Css.CONTENT.indexOf('.blocklyToolboxDiv {') + 1, 1, 'position: relative; width: 120px;');
    Blockly.Css.CONTENT.splice(Blockly.Css.CONTENT.indexOf('.blocklyTreeIcon {') + 1, 4, '');
    Blockly.Css.CONTENT.splice(Blockly.Css.CONTENT.indexOf('.blocklyTreeRoot {') + 1, 0, 'position: absolute; bottom: 0px; width: 100%;');

    Blockly.Css.CONTENT.push('#\\:1 .blocklyTreeRow {background-color: ' + colorForId(1) + '; border: 3px solid ' + colorForId(1) + '}');
    Blockly.Css.CONTENT.push('#\\:2 .blocklyTreeRow {background-color: ' + colorForId(2) + '; border: 3px solid ' + colorForId(2) + '}');
    Blockly.Css.CONTENT.push('#\\:3 .blocklyTreeRow {background-color: ' + colorForId(3) + '; border: 3px solid ' + colorForId(3) + '}');
    Blockly.Css.CONTENT.push('#\\:4 .blocklyTreeRow {background-color: ' + colorForId(4) + '; border: 3px solid ' + colorForId(4) + '}');
    Blockly.Css.CONTENT.push('#\\:5 .blocklyTreeRow {background-color: ' + colorForId(5) + '; border: 3px solid ' + colorForId(5) + '}');
    Blockly.Css.CONTENT.push('#\\:6 .blocklyTreeRow {background-color: ' + colorForId(6) + '; border: 3px solid ' + colorForId(6) + '}');
    Blockly.Css.CONTENT.push('#\\:7 .blocklyTreeRow {background-color: ' + colorForId(7) + '; border: 3px solid ' + colorForId(7) + '}');

    Blockly.inject(document.getElementById('blocklyDiv'),
        {path: './', toolbox: document.getElementById('toolbox'), scrollbars: false});

  </script>
</html>
