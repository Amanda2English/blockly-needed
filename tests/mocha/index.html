<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Mocha Tests for Blockly</title>

    <link href="https://unpkg.com/mocha@5.2.0/mocha.css" rel="stylesheet" />
    <script src="../../blockly_uncompressed.js"></script>
    <script src="../../generators/dart.js"></script>
    <script src="../../generators/javascript.js"></script>
    <script src="../../generators/lua.js"></script>
    <script src="../../generators/php.js"></script>
    <script src="../../generators/python.js"></script>

    <script src="../../generators/dart/text.js"></script>
    <script src="../../generators/javascript/text.js"></script>
    <script src="../../generators/lua/text.js"></script>
    <script src="../../generators/php/text.js"></script>
    <script src="../../generators/python/text.js"></script>

    <script src="../../msg/messages.js"></script>
    <script src="../../blocks/loops.js"></script>
    <script src="../../blocks/lists.js"></script>
    <script src="../../blocks/logic.js"></script>
    <script src="../../blocks/math.js"></script>
    <script src="../../blocks/procedures.js"></script>
    <script src="../../blocks/text.js"></script>

    <script src="../../core/workspace_comment.js"></script>
  </head>
  <style>
    #blocklyDiv {
      height: 1000px;
      position: fixed;
      visibility: hidden;
      width: 1000px;
    }
  </style>
  <body>
    <div id="mocha"></div>
    <div id="failureCount" style="display:none" tests_failed="unset"></div>
    <script src="https://unpkg.com/chai/chai.js"></script>
    <script src="https://unpkg.com/mocha@5.2.0/mocha.js"></script>
    <script src="https://unpkg.com/sinon/pkg/sinon.js"></script>
    <script src="https://unpkg.com/@blockly/dev-tools/dist/index.js"></script>
    <script>
      mocha.setup({
        ui: 'tdd'
      });
    </script>

    <div id="blocklyDiv"></div>
    <xml xmlns="https://developers.google.com/blockly/xml" id="toolbox-simple" style="display: none">
      <block type="logic_operation"></block>
      <sep gap="20"></sep>
      <button text="insert" callbackkey="insertConnectionRows"></button>
      <label text="tooltips"></label>
    </xml>
    <xml xmlns="https://developers.google.com/blockly/xml" id="toolbox-categories" style="display: none">
      <category name="First" css-container="something">
        <block type="basic_block">
          <field name="TEXT">FirstCategory-FirstBlock</field>
        </block>
        <block type="basic_block">
          <field name="TEXT">FirstCategory-SecondBlock</field>
        </block>
      </category>
      <category name="Second">
        <block type="basic_block">
          <field name="TEXT">SecondCategory-FirstBlock</field>
        </block>
      </category>
    </xml>
    <xml xmlns="https://developers.google.com/blockly/xml" id="toolbox-test" style="display: none">
      <category name="First" expanded="true" categorystyle="logic_category">
        <sep gap="-1"></sep>
        <button text="insert" callbackkey="insertConnectionRows"></button>
        <block type="stack_block"></block>
        <block type="stack_block"></block>
      </category>
      <category name="Second">
        <block type="stack_block"></block>
      </category>
      <sep toolboxitemid="separator" gap="-1"></sep>
      <category name="Variables" custom="VARIABLE"></category>
      <category name="NestedCategory" >
        <category toolboxitemid="nestedCategory" name="NestedItemOne"></category>
      </category>
      <category name="lastItem"></category>
    </xml>

    <xml xmlns="https://developers.google.com/blockly/xml" id="gesture-test-toolbox" style="display: none">
      <block type="test_field_block"></block>
    </xml>

    <script type="module">
      import './all_tests.js';

      mocha.run(function(failures) {
        var failureDiv = document.getElementById('failureCount');
        failureDiv.setAttribute('tests_failed', failures);
      });
    </script>
  </body>
</html>
